<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horror Overlay v3 ‚Äî FULL FEATURES</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=Oswald:wght@400;700&family=Roboto+Condensed:wght@400;700&family=Share+Tech+Mono&family=UnifrakturMaguntia&display=swap');

        :root {
            --blood-red: #c90000;
            --dark-red: #5a0000;
            --glass-bg: rgba(8, 8, 8, 0.85);
            --text-main: #f4f4f4;
            --text-muted: #a0a0a0;
        }

        *, *::before, *::after { box-sizing: border-box; }

        body {
            margin: 0; padding: 0; width: 1920px; height: 1080px;
            background-color: #050505; overflow: hidden; position: relative;
            color: white; font-family: 'Roboto Condensed', sans-serif;
            transition: filter 0.3s ease;
        }
        body.brightened { filter: brightness(1.6) saturate(0.3) !important; }
        body.screen-shake { animation: screen-shake 0.5s ease forwards; }

        /* ============================================================
           WEBCAM
        ============================================================ */
        #webcam-feed {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: 0;
            filter: grayscale(40%) contrast(120%) brightness(80%) sepia(20%) hue-rotate(320deg);
            transform-origin: center center;
            transition: all 1.2s cubic-bezier(0.25, 1, 0.5, 1);
        }
        body.shoutout-mode #webcam-feed {
            transform: perspective(1500px) rotateY(15deg) scale(0.65) translateX(5%) translateY(-5%);
            box-shadow: 30px 30px 100px rgba(0,0,0,1);
            border: 4px solid var(--dark-red); border-radius: 15px;
            filter: grayscale(80%) contrast(150%) brightness(60%);
        }
        body.story-mode #webcam-feed {
            left: auto; right: 0; width: 52%; height: 100%; object-fit: cover;
            border-left: 5px solid var(--blood-red); border-radius: 0;
            filter: grayscale(35%) contrast(115%) brightness(85%) sepia(15%) hue-rotate(320deg);
            box-shadow: -40px 0 120px rgba(0,0,0,0.95);
        }
        /* Fear Max ‚Äî screen reddens */
        body.fear-max #webcam-feed {
            filter: grayscale(0%) contrast(130%) brightness(70%) sepia(60%) hue-rotate(320deg) saturate(200%);
        }

        /* ============================================================
           BROADCAST EFFECTS
        ============================================================ */
        .vignette { position: absolute; top: 0; left: 0; width: 100%; height: 100%; box-shadow: 0 0 250px rgba(0,0,0,0.95) inset; pointer-events: none; z-index: 5; }
        .scanlines { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.25) 50%), linear-gradient(90deg, rgba(255,0,0,0.06), rgba(0,255,0,0.02), rgba(0,0,255,0.06)); background-size: 100% 4px, 6px 100%; pointer-events: none; z-index: 50; opacity: 0.6; }
        #glitch-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: url('https://media.giphy.com/media/Yy26NRbp8y4ms/giphy.gif'); opacity: 0; pointer-events: none; z-index: 99; mix-blend-mode: screen; filter: grayscale(100%) contrast(150%); transition: opacity 0.1s; }
        .glitching { opacity: 0.15 !important; }

        /* Red flash overlay for keyword reactions */
        #flash-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(180,0,0,0.0); pointer-events: none; z-index: 98; transition: background 0.05s; }
        #flash-overlay.red-flash { background: rgba(180,0,0,0.35); animation: flash-out 0.6s ease forwards; }
        #flash-overlay.white-flash { background: rgba(255,255,255,0.8); animation: flash-out 0.3s ease forwards; }
        #flash-overlay.dark-flash { background: rgba(0,0,0,0.85); animation: flash-out 1.2s ease forwards; }

        /* ============================================================
           CCTV BUG
        ============================================================ */
        #cctv-bug { position: absolute; top: 40px; left: 40px; z-index: 10; font-family: 'Share Tech Mono', monospace; color: #fff; font-size: 24px; display: flex; align-items: center; gap: 15px; text-shadow: 2px 2px 5px #000; letter-spacing: 2px; }
        .rec-dot { width: 16px; height: 16px; background-color: red; border-radius: 50%; box-shadow: 0 0 10px red; animation: blink 1s infinite; }
        .cctv-text { color: var(--text-muted); }
        .cctv-clock { font-weight: bold; color: #fff; }

        /* ============================================================
           SPONSORS
        ============================================================ */
        #sponsors-container { position: absolute; top: 40px; right: 40px; z-index: 10; background: var(--glass-bg); backdrop-filter: blur(10px); border-left: 3px solid var(--blood-red); padding: 15px 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); display: flex; flex-direction: column; align-items: flex-end; transition: opacity 0.5s, right 0.5s; }
        body.shoutout-mode #sponsors-container { opacity: 0; pointer-events: none; }
        body.story-mode #sponsors-container { right: calc(52% + 20px); }
        .sponsor-title { font-family: 'Oswald', sans-serif; color: var(--text-muted); font-size: 12px; letter-spacing: 4px; text-transform: uppercase; margin-bottom: 10px; }
        .sponsor-images { display: flex; gap: 15px; align-items: center; }
        .sponsor-img { height: 40px; object-fit: contain; filter: drop-shadow(0 0 5px rgba(255,255,255,0.2)); animation: float-logo 4s ease-in-out infinite alternate; }

        /* ============================================================
           FEAR METER
        ============================================================ */
        #fear-meter-wrap {
            position: absolute; left: 40px; top: 50%; transform: translateY(-50%);
            z-index: 12; display: flex; flex-direction: column; align-items: center; gap: 10px;
        }
        .fear-label-top {
            font-family: 'Share Tech Mono', monospace; font-size: 10px;
            letter-spacing: 3px; color: rgba(201,0,0,0.6); text-transform: uppercase;
            writing-mode: vertical-rl; transform: rotate(180deg);
            margin-bottom: 6px;
        }
        #fear-track {
            width: 18px; height: 260px;
            background: rgba(0,0,0,0.7);
            border: 1px solid rgba(201,0,0,0.25);
            border-radius: 9px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.8), inset 0 0 10px rgba(0,0,0,0.5);
        }
        #fear-fill {
            position: absolute; bottom: 0; left: 0; right: 0;
            width: 100%;
            height: 0%;
            background: linear-gradient(to top, #c90000, #ff4400, #ff8800);
            border-radius: 0 0 9px 9px;
            transition: height 0.8s cubic-bezier(0.25, 1, 0.5, 1),
                        background 0.5s ease;
            box-shadow: 0 0 12px rgba(201,0,0,0.6);
        }
        /* Tick marks */
        #fear-track::before {
            content: '';
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: repeating-linear-gradient(to bottom,
                transparent 0px, transparent 24px,
                rgba(255,255,255,0.07) 24px, rgba(255,255,255,0.07) 25px);
            z-index: 2; pointer-events: none;
        }
        .fear-label-bot {
            font-family: 'Share Tech Mono', monospace; font-size: 10px;
            letter-spacing: 3px; color: rgba(201,0,0,0.4);
            writing-mode: vertical-rl; transform: rotate(180deg);
        }
        #fear-percent {
            font-family: 'Share Tech Mono', monospace; font-size: 14px;
            color: var(--blood-red); letter-spacing: 1px;
        }
        body.shoutout-mode #fear-meter-wrap { opacity: 0; }
        body.story-mode #fear-meter-wrap { opacity: 0; }

        /* ============================================================
           EMF GHOST DETECTOR  (bottom-right, above ticker)
        ============================================================ */
        #emf-widget {
            position: absolute; right: 40px; bottom: 75px; z-index: 12;
            width: 200px;
            background: rgba(5,5,5,0.9);
            border: 1px solid rgba(0,255,80,0.2);
            border-top: 2px solid rgba(0,255,80,0.5);
            padding: 12px 16px 14px;
            box-shadow: 0 0 20px rgba(0,0,0,0.9), 0 0 30px rgba(0,255,80,0.05);
            transition: opacity 0.5s;
        }
        body.shoutout-mode #emf-widget { opacity: 0; }
        .emf-header {
            font-family: 'Share Tech Mono', monospace; font-size: 10px;
            letter-spacing: 4px; color: rgba(0,255,80,0.5);
            text-transform: uppercase; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .emf-dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(0,255,80,0.4); animation: blink 2s infinite; }
        .emf-dot.spike { background: #ff4400 !important; box-shadow: 0 0 8px #ff4400; animation: blink 0.3s infinite !important; }

        /* Gauge arc ‚Äî SVG-based */
        #emf-gauge-wrap {
            display: flex; justify-content: center; position: relative;
            margin-bottom: 8px;
        }
        #emf-svg { overflow: visible; }
        #emf-needle {
            transform-origin: 60px 60px;
            transform: rotate(-80deg);
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .emf-reading {
            font-family: 'Share Tech Mono', monospace; font-size: 18px;
            letter-spacing: 2px; text-align: center; color: rgba(0,255,80,0.7);
        }
        .emf-reading.danger { color: #ff4400; text-shadow: 0 0 8px #ff4400; }
        .emf-zone-label {
            font-family: 'Share Tech Mono', monospace; font-size: 9px;
            letter-spacing: 3px; text-align: center; color: rgba(255,255,255,0.15);
            margin-top: 4px;
        }
        .emf-zone-label.active-zone { color: rgba(255,100,0,0.7); }

        /* ============================================================
           SHOUTOUT BOARD ‚Äî SOUL MANIFEST
        ============================================================ */
        #shoutout-board {
            position: absolute; top: 50%; left: 50%;
            width: 520px; max-height: 820px;
            background: linear-gradient(180deg, rgba(12,0,0,0.97) 0%, rgba(6,0,0,0.98) 60%, rgba(3,0,0,0.99) 100%);
            border: 1px solid rgba(201,0,0,0.2);
            box-shadow: 0 0 160px rgba(0,0,0,0.98), 0 0 80px rgba(80,0,0,0.3), inset 0 0 120px rgba(80,0,0,0.1);
            z-index: 15; display: flex; flex-direction: column;
            transform: translate(-50%, -50%) scale(0.88);
            opacity: 0; pointer-events: none;
            transition: transform 0.9s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.5s ease;
            overflow: hidden;
        }
        body.shoutout-mode #shoutout-board { transform: translate(-50%, -50%) scale(1); opacity: 1; pointer-events: all; }
        #shoutout-board::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, transparent 0%, var(--blood-red) 30%, var(--blood-red) 70%, transparent 100%); box-shadow: 0 0 20px rgba(201,0,0,0.8); z-index: 2; }
        #shoutout-board::after { content: ''; position: absolute; inset: 0; background: repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(255,255,255,0.008) 3px, rgba(255,255,255,0.008) 4px); pointer-events: none; z-index: 1; }
        .shoutout-header-wrap { position: relative; z-index: 3; padding: 36px 36px 0; display: flex; flex-direction: column; align-items: center; }
        .shoutout-eyebrow { font-family: 'Share Tech Mono', monospace; font-size: 11px; letter-spacing: 6px; color: rgba(201,0,0,0.7); text-transform: uppercase; margin-bottom: 12px; display: flex; align-items: center; gap: 10px; }
        .shoutout-eyebrow::before, .shoutout-eyebrow::after { content: ''; display: inline-block; width: 30px; height: 1px; background: rgba(201,0,0,0.4); }
        .shoutout-main-title { font-family: 'Cinzel', serif; font-size: 15px; font-weight: 800; letter-spacing: 8px; color: #fff; text-transform: uppercase; text-align: center; text-shadow: 0 0 30px rgba(201,0,0,0.6); margin-bottom: 6px; }
        .shoutout-title-glyph { font-family: 'UnifrakturMaguntia', cursive; font-size: 46px; line-height: 1; color: var(--blood-red); text-shadow: 0 0 40px rgba(201,0,0,0.8); margin-bottom: 8px; animation: glyph-flicker 6s infinite; }
        .shoutout-counter-row { display: flex; align-items: center; gap: 10px; margin-top: 6px; margin-bottom: 20px; }
        .shoutout-count-pill { font-family: 'Share Tech Mono', monospace; font-size: 12px; letter-spacing: 2px; color: var(--blood-red); background: rgba(201,0,0,0.12); border: 1px solid rgba(201,0,0,0.3); padding: 4px 14px; }
        .shoutout-count-label { font-family: 'Share Tech Mono', monospace; font-size: 10px; letter-spacing: 3px; color: rgba(255,255,255,0.25); }
        .shoutout-ornament { width: 100%; display: flex; align-items: center; gap: 12px; }
        .shoutout-ornament-line { flex: 1; height: 1px; background: linear-gradient(to right, transparent, rgba(201,0,0,0.5), transparent); }
        .shoutout-ornament-diamond { width: 7px; height: 7px; background: var(--blood-red); transform: rotate(45deg); box-shadow: 0 0 8px rgba(201,0,0,0.8); flex-shrink: 0; }
        .shoutout-list-wrap { position: relative; z-index: 3; flex: 1; overflow: hidden; padding: 18px 0 10px; mask-image: linear-gradient(to bottom, transparent 0%, black 8%, black 88%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 8%, black 88%, transparent 100%); }
        #shoutout-list { list-style: none; padding: 0 0 10px 0; margin: 0; display: flex; flex-direction: column; gap: 0; }
        .shoutout-item { position: relative; display: flex; align-items: center; justify-content: center; padding: 0 40px; height: 58px; overflow: hidden; border-bottom: 1px solid rgba(255,255,255,0.035); opacity: 0; transform: translateY(20px); animation: soul-enter 0.5s cubic-bezier(0.16,1,0.3,1) forwards; }
        .shoutout-item:first-child { border-top: 1px solid rgba(255,255,255,0.035); }
        .shoutout-item.newest { background: rgba(201,0,0,0.07); }
        .shoutout-item.newest::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background: linear-gradient(to bottom, transparent, var(--blood-red), transparent); box-shadow: 2px 0 10px rgba(201,0,0,0.5); }
        .shoutout-item.newest::after { content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 3px; background: linear-gradient(to bottom, transparent, var(--blood-red), transparent); box-shadow: -2px 0 10px rgba(201,0,0,0.5); }
        .soul-number { font-family: 'Share Tech Mono', monospace; font-size: 11px; letter-spacing: 1px; color: rgba(201,0,0,0.35); width: 26px; flex-shrink: 0; text-align: right; margin-right: 14px; }
        .soul-icon { font-size: 13px; margin-right: 14px; flex-shrink: 0; opacity: 0.4; line-height: 1; }
        .soul-name { font-family: 'Oswald', sans-serif; font-size: 22px; font-weight: 400; letter-spacing: 3px; color: rgba(235,235,235,0.85); text-transform: uppercase; text-align: center; flex: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .shoutout-item.newest .soul-name { color: #fff; font-weight: 600; text-shadow: 0 0 14px rgba(201,0,0,0.45); }
        .soul-pulse { width: 6px; height: 6px; border-radius: 50%; background: var(--blood-red); box-shadow: 0 0 8px rgba(201,0,0,0.9); flex-shrink: 0; margin-left: 14px; opacity: 0; }
        .shoutout-item.newest .soul-pulse { opacity: 1; animation: blink 1.2s infinite; }
        .shoutout-footer { position: relative; z-index: 3; padding: 16px 36px 28px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .shoutout-footer-line { width: 100%; height: 1px; background: linear-gradient(to right, transparent, rgba(201,0,0,0.3), transparent); margin-bottom: 8px; }
        .shoutout-footer-text { font-family: 'Share Tech Mono', monospace; font-size: 10px; letter-spacing: 4px; color: rgba(255,255,255,0.15); text-align: center; text-transform: uppercase; }
        .shoutout-footer-evp { display: flex; gap: 3px; height: 12px; align-items: flex-end; opacity: 0.3; }
        .shoutout-footer-evp .evp-bar { width: 3px; }

        /* ============================================================
           STORY MODE PANEL
        ============================================================ */
        #story-side-panel { position: absolute; top: 0; left: 0; width: 48%; height: 100%; z-index: 8; pointer-events: none; opacity: 0; transition: opacity 1s ease; display: flex; flex-direction: column; justify-content: center; align-items: flex-start; padding: 80px 60px 80px 80px; }
        body.story-mode #story-side-panel { opacity: 1; }
        #story-side-panel::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(5,0,0,0.97) 0%, rgba(10,0,0,0.85) 60%, transparent 100%); z-index: -1; }
        #story-side-panel::after { content: ''; position: absolute; top: 10%; right: 0; width: 4px; height: 80%; background: linear-gradient(to bottom, transparent, var(--blood-red), transparent); }
        .story-panel-eyebrow { font-family: 'Share Tech Mono', monospace; font-size: 14px; letter-spacing: 8px; color: var(--blood-red); text-transform: uppercase; margin-bottom: 18px; opacity: 0; transform: translateY(20px); transition: all 0.8s 0.3s ease; }
        body.story-mode .story-panel-eyebrow { opacity: 1; transform: translateY(0); }
        .story-panel-title { font-family: 'Cinzel', serif; font-size: 72px; line-height: 1.1; font-weight: 800; color: #fff; letter-spacing: 3px; text-shadow: 0 0 60px rgba(201,0,0,0.5), 3px 3px 0 rgba(0,0,0,0.8); margin-bottom: 28px; opacity: 0; transform: translateY(30px); transition: all 0.8s 0.5s ease; }
        body.story-mode .story-panel-title { opacity: 1; transform: translateY(0); }
        .story-panel-divider { width: 120px; height: 3px; background: linear-gradient(to right, var(--blood-red), transparent); margin-bottom: 25px; opacity: 0; transition: all 0.8s 0.7s ease; }
        body.story-mode .story-panel-divider { opacity: 1; }
        .story-panel-desc { font-family: 'Roboto Condensed', sans-serif; font-size: 22px; line-height: 1.7; color: rgba(200,200,200,0.85); max-width: 520px; opacity: 0; transform: translateY(15px); transition: all 0.8s 0.9s ease; }
        body.story-mode .story-panel-desc { opacity: 1; transform: translateY(0); }
        .story-corner-tl, .story-corner-br { position: absolute; pointer-events: none; z-index: 9; opacity: 0; transition: opacity 0.8s 1s; }
        .story-corner-tl { top: 20px; left: 20px; width: 80px; height: 80px; border-top: 3px solid var(--blood-red); border-left: 3px solid var(--blood-red); }
        .story-corner-br { bottom: 20px; left: 200px; width: 60px; height: 60px; border-bottom: 3px solid var(--dark-red); border-right: 3px solid var(--dark-red); }
        body.story-mode .story-corner-tl, body.story-mode .story-corner-br { opacity: 1; }
        .story-evp { display: flex; gap: 4px; height: 20px; align-items: flex-end; margin-top: 35px; opacity: 0; transition: opacity 0.8s 1.1s; }
        body.story-mode .story-evp { opacity: 0.6; }
        .story-evp .evp-bar { width: 5px; background: var(--blood-red); animation: evp-bounce 1.5s infinite ease-in-out; }
        .story-evp .evp-bar:nth-child(1){animation-delay:0.0s;height:30%}.story-evp .evp-bar:nth-child(2){animation-delay:0.2s;height:70%}.story-evp .evp-bar:nth-child(3){animation-delay:0.4s;height:100%}.story-evp .evp-bar:nth-child(4){animation-delay:0.1s;height:50%}.story-evp .evp-bar:nth-child(5){animation-delay:0.3s;height:80%}.story-evp .evp-bar:nth-child(6){animation-delay:0.5s;height:40%}.story-evp .evp-bar:nth-child(7){animation-delay:0.2s;height:60%}

        /* ============================================================
           STORY TRANSITION (N key)
        ============================================================ */
        #story-transition { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 200; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.5s; }
        #story-transition.active { opacity: 1; pointer-events: all; }
        .transition-text { font-family: 'Cinzel', serif; font-size: 100px; color: var(--blood-red); letter-spacing: 20px; text-shadow: 0 0 40px var(--blood-red), 0 0 10px #fff; transform: scale(0.9); transition: transform 4s cubic-bezier(0.25, 1, 0.5, 1); }
        #story-transition.active .transition-text { transform: scale(1.1); }

        /* ============================================================
           WAITING SCREEN (W key)
        ============================================================ */
        #waiting-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 300; display: flex; flex-direction: column; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.8s ease; }
        #waiting-screen.active { opacity: 1; pointer-events: all; }
        .waiting-bg-noise { position: absolute; inset: 0; background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(255,0,0,0.012) 2px, rgba(255,0,0,0.012) 4px); z-index: 0; animation: noise-shift 0.4s steps(2) infinite; }
        .waiting-vignette { position: absolute; inset: 0; box-shadow: 0 0 400px rgba(201,0,0,0.35) inset; z-index: 1; pointer-events: none; }
        .waiting-content { position: relative; z-index: 5; display: flex; flex-direction: column; align-items: center; gap: 0; text-align: center; }
        .waiting-eyebrow { font-family: 'Share Tech Mono', monospace; font-size: 16px; letter-spacing: 12px; color: var(--blood-red); text-transform: uppercase; margin-bottom: 30px; animation: pulse-opacity 2s ease-in-out infinite; }
        .waiting-main-title { font-family: 'UnifrakturMaguntia', cursive; font-size: 140px; line-height: 1; color: #fff; text-shadow: 0 0 80px rgba(201,0,0,0.9), 0 0 20px rgba(201,0,0,0.5); letter-spacing: 5px; margin-bottom: 10px; animation: flicker-title 8s infinite; }
        .waiting-sub { font-family: 'Cinzel', serif; font-size: 30px; letter-spacing: 15px; color: var(--blood-red); text-transform: uppercase; margin-bottom: 60px; text-shadow: 0 0 20px rgba(201,0,0,0.7); }
        .waiting-divider { width: 500px; height: 2px; background: linear-gradient(to right, transparent, var(--blood-red), transparent); margin-bottom: 50px; }
        .waiting-status-row { display: flex; align-items: center; gap: 20px; font-family: 'Share Tech Mono', monospace; font-size: 18px; color: var(--text-muted); letter-spacing: 4px; }
        .waiting-dot { width: 10px; height: 10px; background: var(--blood-red); border-radius: 50%; box-shadow: 0 0 8px red; animation: blink 1.2s infinite; }
        .waiting-dots-loader { display: inline-flex; gap: 8px; align-items: center; margin-left: 5px; }
        .waiting-dots-loader span { display: inline-block; width: 6px; height: 6px; background: var(--blood-red); border-radius: 50%; animation: dot-pulse 1.5s ease-in-out infinite; }
        .waiting-dots-loader span:nth-child(1){animation-delay:0s}.waiting-dots-loader span:nth-child(2){animation-delay:0.3s}.waiting-dots-loader span:nth-child(3){animation-delay:0.6s}
        .waiting-corner { position: absolute; width: 120px; height: 120px; z-index: 5; }
        .waiting-corner.tl { top: 40px; left: 40px; border-top: 2px solid rgba(201,0,0,0.5); border-left: 2px solid rgba(201,0,0,0.5); }
        .waiting-corner.tr { top: 40px; right: 40px; border-top: 2px solid rgba(201,0,0,0.5); border-right: 2px solid rgba(201,0,0,0.5); }
        .waiting-corner.bl { bottom: 90px; left: 40px; border-bottom: 2px solid rgba(201,0,0,0.5); border-left: 2px solid rgba(201,0,0,0.5); }
        .waiting-corner.br { bottom: 90px; right: 40px; border-bottom: 2px solid rgba(201,0,0,0.5); border-right: 2px solid rgba(201,0,0,0.5); }
        .waiting-drips { position: absolute; top: 0; left: 0; width: 100%; height: 60px; z-index: 6; }
        .drip { position: absolute; top: 0; width: 3px; background: linear-gradient(to bottom, var(--blood-red), #8b0000, transparent); border-radius: 0 0 50% 50%; animation: drip-fall 3s ease-in-out infinite; opacity: 0.6; }
        .drip:nth-child(1){left:8%;height:35px;animation-delay:0s}.drip:nth-child(2){left:15%;height:55px;animation-delay:0.8s}.drip:nth-child(3){left:25%;height:28px;animation-delay:1.5s}.drip:nth-child(4){left:38%;height:45px;animation-delay:0.3s}.drip:nth-child(5){left:52%;height:60px;animation-delay:1.1s}.drip:nth-child(6){left:65%;height:32px;animation-delay:0.6s}.drip:nth-child(7){left:75%;height:48px;animation-delay:2.0s}.drip:nth-child(8){left:85%;height:38px;animation-delay:0.4s}.drip:nth-child(9){left:92%;height:52px;animation-delay:1.7s}

        /* ============================================================
           JUMPSCARE (J key)
        ============================================================ */
        #jumpscare-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 500;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none;
            animation: none;
        }
        #jumpscare-overlay.active {
            animation: jumpscare-anim 0.8s ease forwards;
        }
        .jumpscare-inner {
            display: flex; flex-direction: column; align-items: center;
            transform: scale(1);
        }
        .jumpscare-face {
            font-size: 300px; line-height: 1;
            filter: brightness(0) invert(1) sepia(1) saturate(5) hue-rotate(320deg);
            animation: none;
        }
        #jumpscare-overlay.active .jumpscare-face {
            animation: face-shake 0.8s ease forwards;
        }
        .jumpscare-text {
            font-family: 'Cinzel', serif; font-size: 80px; font-weight: 800;
            color: #fff; letter-spacing: 20px; text-transform: uppercase;
            text-shadow: 0 0 40px red, 0 0 80px red;
        }

        /* ============================================================
           RAID ALERT (R key)
        ============================================================ */
        #raid-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 400;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none;
            transition: opacity 0.4s ease;
            overflow: hidden;
        }
        #raid-overlay.active { opacity: 1; pointer-events: all; }
        .raid-bg-lines {
            position: absolute; inset: 0;
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(201,0,0,0.04) 10px, rgba(201,0,0,0.04) 20px);
            animation: raid-lines-move 3s linear infinite;
        }
        .raid-vignette { position: absolute; inset: 0; box-shadow: 0 0 500px rgba(201,0,0,0.6) inset; z-index: 1; }
        .raid-content { position: relative; z-index: 5; display: flex; flex-direction: column; align-items: center; gap: 0; }
        .raid-alert-tag {
            font-family: 'Share Tech Mono', monospace; font-size: 16px;
            letter-spacing: 10px; color: var(--blood-red); text-transform: uppercase;
            border: 1px solid rgba(201,0,0,0.4); padding: 8px 30px;
            margin-bottom: 24px;
            animation: pulse-opacity 1s ease-in-out infinite;
        }
        .raid-main-text {
            font-family: 'Cinzel', serif; font-size: 110px; font-weight: 800;
            color: #fff; letter-spacing: 8px; line-height: 0.9;
            text-shadow: 0 0 80px rgba(201,0,0,0.9), 0 0 20px rgba(201,0,0,0.5), 4px 4px 0 rgba(100,0,0,0.8);
            text-align: center;
            animation: flicker-title 3s infinite;
        }
        .raid-channel-name {
            font-family: 'Oswald', sans-serif; font-size: 55px;
            color: var(--blood-red); letter-spacing: 5px; text-transform: uppercase;
            text-shadow: 0 0 30px rgba(201,0,0,0.8);
            margin-top: 10px; margin-bottom: 30px;
        }
        .raid-sub-text {
            font-family: 'Share Tech Mono', monospace; font-size: 18px;
            letter-spacing: 5px; color: rgba(255,255,255,0.4);
            text-transform: uppercase;
        }
        .raid-count-display {
            font-family: 'Share Tech Mono', monospace; font-size: 50px;
            color: rgba(201,0,0,0.8); letter-spacing: 3px;
            margin-top: 8px;
        }
        /* Horizontal scan line on raid */
        .raid-scan-line {
            position: absolute; left: 0; right: 0; height: 3px;
            background: linear-gradient(90deg, transparent, rgba(201,0,0,0.8), transparent);
            animation: raid-scan 3s linear infinite;
            z-index: 6;
        }

        /* ============================================================
           SUPER CHAT ALERT
        ============================================================ */
        #superchat-alert {
            position: absolute; top: 120px; left: 50%;
            transform: translateX(-50%) translateY(-30px);
            min-width: 700px; max-width: 900px;
            background: linear-gradient(135deg, rgba(8,5,0,0.98), rgba(12,8,0,0.97));
            border: 1px solid rgba(255,165,0,0.3);
            border-top: 3px solid #ff8c00;
            box-shadow: 0 0 60px rgba(255,100,0,0.25), 0 20px 80px rgba(0,0,0,0.95);
            z-index: 25;
            opacity: 0; pointer-events: none;
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            overflow: hidden;
        }
        #superchat-alert.show {
            opacity: 1; transform: translateX(-50%) translateY(0);
        }
        .sc-top-bar {
            background: linear-gradient(90deg, #8b4500, #c06000, #8b4500);
            padding: 10px 28px;
            display: flex; align-items: center; justify-content: space-between;
        }
        .sc-label {
            font-family: 'Share Tech Mono', monospace; font-size: 11px;
            letter-spacing: 5px; color: rgba(255,200,100,0.9); text-transform: uppercase;
        }
        .sc-amount {
            font-family: 'Cinzel', serif; font-size: 22px; font-weight: 800;
            color: #ffd700; text-shadow: 0 0 10px rgba(255,200,0,0.8);
            letter-spacing: 3px;
        }
        .sc-body {
            padding: 20px 28px 24px;
            display: flex; align-items: center; gap: 20px;
        }
        .sc-avatar {
            width: 64px; height: 64px; border-radius: 50%; object-fit: cover;
            border: 2px solid rgba(255,140,0,0.5);
            filter: sepia(20%) contrast(1.1);
            flex-shrink: 0;
        }
        .sc-text-block { flex: 1; }
        .sc-author {
            font-family: 'Oswald', sans-serif; font-size: 26px;
            color: #ffd700; letter-spacing: 2px; text-transform: uppercase;
            text-shadow: 0 0 15px rgba(255,200,0,0.5);
            margin-bottom: 6px;
        }
        .sc-message {
            font-family: 'Roboto Condensed', sans-serif; font-size: 20px;
            color: rgba(240,220,180,0.9); line-height: 1.4;
        }
        /* Shimmer effect on superchat */
        #superchat-alert::before {
            content: '';
            position: absolute; top: 0; left: -100%; width: 60%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,200,0,0.05), transparent);
            animation: sc-shimmer 3s linear infinite;
        }

        /* ============================================================
           GHOST NOTIFICATION (random)
        ============================================================ */
        #ghost-notification {
            position: absolute; right: 40px; bottom: 80px;
            z-index: 30;
            background: rgba(5,5,5,0.95);
            border: 1px solid rgba(201,0,0,0.2);
            border-left: 3px solid var(--blood-red);
            padding: 14px 20px 14px 16px;
            min-width: 320px; max-width: 420px;
            box-shadow: -10px 10px 40px rgba(0,0,0,0.9), 0 0 20px rgba(201,0,0,0.1);
            transform: translateX(120%);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }
        #ghost-notification.show {
            transform: translateX(0); opacity: 1;
        }
        .ghost-notif-header {
            font-family: 'Share Tech Mono', monospace; font-size: 10px;
            letter-spacing: 4px; color: rgba(201,0,0,0.6);
            text-transform: uppercase; margin-bottom: 6px;
            display: flex; align-items: center; gap: 8px;
        }
        .ghost-notif-dot { width: 5px; height: 5px; border-radius: 50%; background: var(--blood-red); animation: blink 0.8s infinite; }
        .ghost-notif-msg {
            font-family: 'Roboto Condensed', sans-serif; font-size: 18px;
            color: rgba(230,230,230,0.9); letter-spacing: 1px;
        }
        .ghost-notif-time {
            font-family: 'Share Tech Mono', monospace; font-size: 10px;
            color: rgba(255,255,255,0.2); letter-spacing: 2px; margin-top: 6px;
        }

        /* ============================================================
           KEYWORD REACTION TEXT POP
        ============================================================ */
        #keyword-pop {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.6);
            z-index: 150;
            font-family: 'Cinzel', serif; font-size: 120px; font-weight: 800;
            letter-spacing: 10px; text-transform: uppercase;
            text-align: center;
            color: #fff;
            text-shadow: 0 0 60px red, 0 0 20px red;
            opacity: 0;
            pointer-events: none;
            transition: none;
        }
        #keyword-pop.pop-in {
            animation: keyword-pop-anim 1.2s cubic-bezier(0.16,1,0.3,1) forwards;
        }

        /* ============================================================
           COMMENTS
        ============================================================ */
        #comment-wrapper { position: absolute; bottom: 90px; left: 60px; z-index: 20; width: 750px; transition: transform 0.5s, opacity 0.5s; }
        body.shoutout-mode #comment-wrapper { transform: translateY(200px); opacity: 0; }
        .evp-visualizer { display: flex; gap: 3px; height: 15px; margin-bottom: 8px; margin-left: 10px; align-items: flex-end; opacity: 0.7; }
        .evp-bar { width: 4px; background: var(--blood-red); animation: evp-bounce 1.2s infinite ease-in-out; }
        .evp-bar:nth-child(1){animation-delay:0.1s;height:40%}.evp-bar:nth-child(2){animation-delay:0.3s;height:80%}.evp-bar:nth-child(3){animation-delay:0.0s;height:100%}.evp-bar:nth-child(4){animation-delay:0.4s;height:60%}.evp-bar:nth-child(5){animation-delay:0.2s;height:50%}
        #comment-container { background: linear-gradient(90deg, var(--glass-bg) 0%, rgba(15,15,15,0.6) 100%); backdrop-filter: blur(15px); border-left: 6px solid var(--blood-red); box-shadow: 20px 20px 50px rgba(0,0,0,0.9); padding: 0; display: flex; flex-direction: row; transform: translateX(-120%); opacity: 0; transition: all 0.7s cubic-bezier(0.25, 1, 0.5, 1); overflow: hidden; }
        #comment-container.show { transform: translateX(0); opacity: 1; }
        .avatar-box { background: #000; padding: 20px; display: flex; align-items: center; justify-content: center; border-right: 1px solid rgba(255,255,255,0.05); }
        .avatar { width: 70px; height: 70px; border-radius: 4px; object-fit: cover; filter: grayscale(80%) contrast(1.2); box-shadow: 0 0 15px rgba(201,0,0,0.5); }
        .content-box { padding: 20px 30px; display: flex; flex-direction: column; justify-content: center; width: 100%; }
        .comment-author { font-family: 'Oswald', sans-serif; font-size: 24px; font-weight: 700; color: var(--blood-red); letter-spacing: 1px; text-transform: uppercase; margin-bottom: 5px; }
        .comment-text { font-family: 'Roboto Condensed', sans-serif; font-size: 22px; line-height: 1.4; color: var(--text-main); }

        /* ============================================================
           NEWS TICKER
        ============================================================ */
        #news-ticker { position: absolute; bottom: 0; left: 0; width: 100%; height: 55px; background: #080808; border-top: 2px solid var(--blood-red); display: flex; align-items: center; overflow: hidden; z-index: 40; box-shadow: 0 -10px 30px rgba(0,0,0,0.8); }
        .ticker-label { background: var(--blood-red); color: #fff; font-family: 'Oswald', sans-serif; font-weight: 700; font-size: 22px; padding: 0 30px; height: 100%; display: flex; align-items: center; letter-spacing: 2px; position: relative; z-index: 45; box-shadow: 10px 0 20px rgba(0,0,0,0.5); flex-shrink: 0; }
        .ticker-wrapper { white-space: nowrap; display: inline-block; padding-left: 20px; animation: scroll-ticker 30s linear infinite; }
        .ticker-text { font-family: 'Roboto Condensed', sans-serif; font-weight: 400; font-size: 24px; color: var(--text-main); text-transform: uppercase; letter-spacing: 2px; padding-right: 60px; }
        .ticker-highlight { color: var(--blood-red); font-weight: 700; }

        /* ============================================================
           ANIMATIONS
        ============================================================ */
        @keyframes scroll-ticker { 0% { transform: translateX(100vw); } 100% { transform: translateX(-100%); } }
        @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }
        @keyframes evp-bounce { 0%,100%{height:30%} 50%{height:100%} }
        @keyframes float-logo { 0%{transform:translateY(0)} 100%{transform:translateY(-3px)} }
        @keyframes soul-enter { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
        @keyframes glyph-flicker { 0%,18%,20%,22%,60%,62%,100%{opacity:1} 19%,21%,61%{opacity:0.7;text-shadow:none} }
        @keyframes pulse-opacity { 0%,100%{opacity:0.6} 50%{opacity:1} }
        @keyframes flicker-title { 0%,19%,21%,23%,25%,54%,56%,100%{text-shadow:0 0 80px rgba(201,0,0,0.9),0 0 20px rgba(201,0,0,0.5)} 20%,24%,55%{text-shadow:none;opacity:0.85} }
        @keyframes noise-shift { 0%{background-position:0 0} 100%{background-position:0 4px} }
        @keyframes drip-fall { 0%{transform:scaleY(0.3);opacity:0} 30%{opacity:0.7} 70%{transform:scaleY(1);opacity:0.6} 100%{transform:scaleY(0.3);opacity:0} }
        @keyframes dot-pulse { 0%,100%{opacity:0.2;transform:scale(0.8)} 50%{opacity:1;transform:scale(1.2)} }
        @keyframes flash-out { 0%{opacity:1} 100%{opacity:0} }
        @keyframes screen-shake {
            0%{transform:translate(0,0)} 15%{transform:translate(-8px,5px)} 30%{transform:translate(8px,-5px)}
            45%{transform:translate(-6px,3px)} 60%{transform:translate(6px,-3px)}
            75%{transform:translate(-3px,2px)} 90%{transform:translate(3px,-2px)} 100%{transform:translate(0,0)}
        }
        @keyframes jumpscare-anim {
            0%{opacity:0} 5%{opacity:1} 15%{opacity:0.7} 20%{opacity:1} 80%{opacity:1} 100%{opacity:0}
        }
        @keyframes face-shake {
            0%{transform:rotate(-3deg) scale(1.1)} 20%{transform:rotate(3deg) scale(1.15)} 40%{transform:rotate(-2deg) scale(1.12)} 60%{transform:rotate(2deg) scale(1.1)} 80%{transform:rotate(-1deg) scale(1.08)} 100%{transform:rotate(0) scale(1)}
        }
        @keyframes raid-lines-move { 0%{background-position:0 0} 100%{background-position:40px 40px} }
        @keyframes raid-scan { 0%{top:-3px} 100%{top:100%} }
        @keyframes sc-shimmer { 0%{left:-100%} 100%{left:200%} }
        @keyframes keyword-pop-anim {
            0%{opacity:0;transform:translate(-50%,-50%) scale(0.5)}
            20%{opacity:1;transform:translate(-50%,-50%) scale(1.05)}
            35%{transform:translate(-50%,-50%) scale(0.98)}
            50%{opacity:1;transform:translate(-50%,-50%) scale(1)}
            80%{opacity:1;transform:translate(-50%,-50%) scale(1)}
            100%{opacity:0;transform:translate(-50%,-50%) scale(1.1)}
        }
    </style>
</head>
<body>

    <!-- WEBCAM -->
    <video id="webcam-feed" autoplay muted playsinline></video>

    <!-- EFFECTS -->
    <div class="vignette"></div>
    <div class="scanlines"></div>
    <div id="glitch-overlay"></div>
    <div id="flash-overlay"></div>

    <!-- AUDIO -->
    <audio id="horror-sfx" src="creepy-whoosh.mp3" preload="auto"></audio>
    <audio id="jumpscare-sfx" src="jumpscare.mp3" preload="auto"></audio>
    <audio id="emf-beep" preload="auto">
        <source src="emf-beep.mp3">
    </audio>
    <audio id="raid-sfx" src="raid-alert.mp3" preload="auto"></audio>
    <audio id="superchat-sfx" src="superchat.mp3" preload="auto"></audio>

    <!-- STORY TRANSITION -->
    <div id="story-transition"><div class="transition-text" id="transition-text">NEXT STORY</div></div>

    <!-- JUMPSCARE -->
    <div id="jumpscare-overlay">
        <div class="jumpscare-inner">
            <div class="jumpscare-face">üíÄ</div>
        </div>
    </div>

    <!-- RAID ALERT -->
    <div id="raid-overlay">
        <div class="raid-bg-lines"></div>
        <div class="raid-vignette"></div>
        <div class="raid-scan-line"></div>
        <div class="raid-content">
            <div class="raid-alert-tag">‚ö† Incoming Signal ‚ö†</div>
            <div class="raid-main-text">YOU ARE<br>BEING RAIDED</div>
            <div class="raid-channel-name" id="raid-channel-name">Unknown Raider</div>
            <div class="raid-sub-text">SOULS INCOMING</div>
            <div class="raid-count-display" id="raid-viewer-count">???</div>
        </div>
        <div class="scanlines" style="z-index:7;opacity:0.3;"></div>
    </div>

    <!-- SUPER CHAT ALERT -->
    <div id="superchat-alert">
        <div class="sc-top-bar">
            <div class="sc-label">‚ö° Super Chat Received</div>
            <div class="sc-amount" id="sc-amount">‚Ç±0.00</div>
        </div>
        <div class="sc-body">
            <img class="sc-avatar" id="sc-avatar" src="https://via.placeholder.com/64/111/fff?text=?" alt="SC Avatar">
            <div class="sc-text-block">
                <div class="sc-author" id="sc-author">Anonymous</div>
                <div class="sc-message" id="sc-message">‚Äî</div>
            </div>
        </div>
    </div>

    <!-- KEYWORD POP TEXT -->
    <div id="keyword-pop"></div>

    <!-- WAITING SCREEN -->
    <div id="waiting-screen">
        <div class="waiting-bg-noise"></div>
        <div class="waiting-vignette"></div>
        <div class="waiting-drips">
            <div class="drip"></div><div class="drip"></div><div class="drip"></div>
            <div class="drip"></div><div class="drip"></div><div class="drip"></div>
            <div class="drip"></div><div class="drip"></div><div class="drip"></div>
        </div>
        <div class="waiting-corner tl"></div><div class="waiting-corner tr"></div>
        <div class="waiting-corner bl"></div><div class="waiting-corner br"></div>
        <div class="waiting-content">
            <div class="waiting-eyebrow">‚ö† Broadcast Initializing ‚ö†</div>
            <div class="waiting-main-title">Huwag Matulog</div>
            <div class="waiting-sub">Storytelling Night</div>
            <div class="waiting-divider"></div>
            <div class="waiting-status-row">
                <div class="waiting-dot"></div>
                <span>STREAM STARTING SOON</span>
                <div class="waiting-dots-loader"><span></span><span></span><span></span></div>
            </div>
        </div>
        <div class="scanlines" style="z-index:6;opacity:0.4;"></div>
    </div>

    <!-- CCTV BUG -->
    <div id="cctv-bug">
        <div class="rec-dot"></div>
        <span>REC</span>
        <span class="cctv-text">| CAM 04 - TALIM ISLAND |</span>
        <span class="cctv-clock" id="live-clock">00:00:00</span>
    </div>

    <!-- SPONSORS -->
    <div id="sponsors-container">
        <div class="sponsor-title">Sponsored By</div>
        <div class="sponsor-images" id="sponsor-images">
            <img src="https://via.placeholder.com/120x40/222/fff?text=Sponsor" alt="Sponsor" class="sponsor-img">
        </div>
    </div>

    <!-- FEAR METER -->
    <div id="fear-meter-wrap">
        <div class="fear-label-top">Fear Level</div>
        <div id="fear-track">
            <div id="fear-fill"></div>
        </div>
        <div id="fear-percent">0%</div>
        <div class="fear-label-bot">E.V.P</div>
    </div>

    <!-- EMF GHOST DETECTOR -->
    <div id="emf-widget">
        <div class="emf-header">
            <span>EMF RDR-6</span>
            <div class="emf-dot" id="emf-status-dot"></div>
        </div>
        <div id="emf-gauge-wrap">
            <svg id="emf-svg" width="120" height="70" viewBox="0 0 120 70">
                <!-- Arc background -->
                <path d="M 10 65 A 50 50 0 0 1 110 65" fill="none" stroke="rgba(0,255,80,0.08)" stroke-width="8" stroke-linecap="round"/>
                <!-- Zone colors -->
                <path d="M 10 65 A 50 50 0 0 1 45 22" fill="none" stroke="rgba(0,200,60,0.25)" stroke-width="8" stroke-linecap="round"/>
                <path d="M 45 22 A 50 50 0 0 1 80 18" fill="none" stroke="rgba(255,180,0,0.25)" stroke-width="8" stroke-linecap="round"/>
                <path d="M 80 18 A 50 50 0 0 1 110 65" fill="none" stroke="rgba(255,50,0,0.3)" stroke-width="8" stroke-linecap="round"/>
                <!-- Zone labels -->
                <text x="8" y="62" fill="rgba(0,255,80,0.35)" font-size="7" font-family="monospace">LOW</text>
                <text x="90" y="62" fill="rgba(255,50,0,0.5)" font-size="7" font-family="monospace">MAX</text>
                <!-- Needle -->
                <g id="emf-needle">
                    <line x1="60" y1="65" x2="60" y2="22" stroke="rgba(0,255,80,0.9)" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="60" cy="65" r="4" fill="rgba(0,255,80,0.4)" stroke="rgba(0,255,80,0.6)" stroke-width="1"/>
                </g>
            </svg>
        </div>
        <div class="emf-reading" id="emf-reading">0.0 mG</div>
        <div class="emf-zone-label" id="emf-zone-label">NO ACTIVITY</div>
    </div>

    <!-- SHOUTOUT BOARD -->
    <div id="shoutout-board">
        <div class="shoutout-header-wrap">
            <div class="shoutout-eyebrow">Live Witnesses</div>
            <div class="shoutout-main-title">Souls Acknowledged</div>
            <div class="shoutout-title-glyph">‚Ä†</div>
            <div class="shoutout-counter-row">
                <div class="shoutout-count-pill"><span id="soul-count">0</span> SOULS</div>
                <div class="shoutout-count-label">IN THIS BROADCAST</div>
            </div>
            <div class="shoutout-ornament">
                <div class="shoutout-ornament-line"></div>
                <div class="shoutout-ornament-diamond"></div>
                <div class="shoutout-ornament-line"></div>
            </div>
        </div>
        <div class="shoutout-list-wrap">
            <ul id="shoutout-list">
                <li class="shoutout-item" style="opacity:0.4;animation:none;">
                    <span class="soul-number">‚Äî</span>
                    <span class="soul-icon">‚òΩ</span>
                    <span class="soul-name" style="color:rgba(255,255,255,0.3);font-size:16px;letter-spacing:4px;">AWAITING VICTIMS</span>
                </li>
            </ul>
        </div>
        <div class="shoutout-footer">
            <div class="shoutout-footer-line"></div>
            <div class="shoutout-footer-evp">
                <div class="evp-bar"></div><div class="evp-bar"></div>
                <div class="evp-bar"></div><div class="evp-bar"></div><div class="evp-bar"></div>
            </div>
            <div class="shoutout-footer-text">Thank you for watching</div>
        </div>
    </div>

    <!-- STORY MODE PANEL -->
    <div id="story-side-panel">
        <div class="story-panel-eyebrow">‚Åé Now Telling ‚Åé</div>
        <div class="story-panel-title" id="story-panel-title">KWENTONG<br>GABI</div>
        <div class="story-panel-divider"></div>
        <div class="story-panel-desc" id="story-panel-desc">Huwag nang maghanap ng ilaw.<br>Ang takot ay kasama mo na.</div>
        <div class="story-evp">
            <div class="evp-bar"></div><div class="evp-bar"></div><div class="evp-bar"></div>
            <div class="evp-bar"></div><div class="evp-bar"></div><div class="evp-bar"></div><div class="evp-bar"></div>
        </div>
    </div>
    <div class="story-corner-tl"></div>
    <div class="story-corner-br"></div>

    <!-- COMMENTS -->
    <div id="comment-wrapper">
        <div class="evp-visualizer">
            <div class="evp-bar"></div><div class="evp-bar"></div>
            <div class="evp-bar"></div><div class="evp-bar"></div><div class="evp-bar"></div>
        </div>
        <div id="comment-container">
            <div class="avatar-box">
                <img src="https://via.placeholder.com/70/111/fff?text=?" alt="Avatar" class="avatar" id="comment-avatar">
            </div>
            <div class="content-box">
                <div class="comment-author" id="comment-author">System Loading</div>
                <div class="comment-text" id="comment-text">Establishing connection...</div>
            </div>
        </div>
    </div>

    <!-- GHOST NOTIFICATION -->
    <div id="ghost-notification">
        <div class="ghost-notif-header">
            <div class="ghost-notif-dot"></div>
            <span>SYSTEM ALERT</span>
        </div>
        <div class="ghost-notif-msg" id="ghost-notif-msg">Unknown presence detected</div>
        <div class="ghost-notif-time" id="ghost-notif-time">00:00:00</div>
    </div>

    <!-- NEWS TICKER -->
    <div id="news-ticker">
        <div class="ticker-label">LIVE ALERT</div>
        <div class="ticker-wrapper">
            <span class="ticker-text">YOU ARE WATCHING A LIVE STORYTELLING BROADCAST. <span class="ticker-highlight">SUBSCRIBE NOW</span> TO SUPPORT THE CHANNEL.</span>
            <span class="ticker-text">DO NOT WATCH THIS ALONE. <span class="ticker-highlight">LIKE AND SUBSCRIBE</span> IF YOU SURVIVE THE NIGHT.</span>
            <span class="ticker-text">TYPE <span class="ticker-highlight">TAKOT</span> IN THE CHAT IF YOU FEEL IT TOO.</span>
        </div>
    </div>

    <script>
        // ============================================================
        // CONFIG
        // ============================================================
        let API_KEY  = 'AIzaSyBADtw_0ahV9nKATpBRq9mCgbU1_vqnyFI';
        let VIDEO_ID = '0NdX9x0AQSQ';

        function loadSavedSettings() {
            const savedVID      = localStorage.getItem('horror_video_id');
            const savedSponsors = localStorage.getItem('horror_sponsors');
            if (savedVID)      VIDEO_ID = savedVID;
            if (savedSponsors) renderSponsors(JSON.parse(savedSponsors));
        }
        function renderSponsors(sponsors) {
            const c = document.getElementById('sponsor-images');
            c.innerHTML = '';
            if (!sponsors || !sponsors.length) return;
            sponsors.forEach(s => {
                const img = document.createElement('img');
                img.src = s.url; img.alt = s.alt || 'Sponsor';
                img.className = 'sponsor-img';
                img.onerror = () => { img.style.display='none'; };
                c.appendChild(img);
            });
        }
        loadSavedSettings();

        // ============================================================
        // BROADCAST CHANNEL (Control Panel)
        // ============================================================
        const channel = new BroadcastChannel('horror-overlay-ctrl');
        channel.addEventListener('message', (e) => {
            const msg = e.data;
            if (!msg || !msg.type) return;
            if (msg.type === 'UPDATE_VIDEO_ID') {
                VIDEO_ID = msg.videoId;
                localStorage.setItem('horror_video_id', VIDEO_ID);
                liveChatId = ''; nextPageToken = ''; commentQueue = [];
                getLiveChatId();
            }
            if (msg.type === 'UPDATE_SPONSORS') {
                localStorage.setItem('horror_sponsors', JSON.stringify(msg.sponsors));
                renderSponsors(msg.sponsors);
            }
            if (msg.type === 'UPDATE_STORY_TEXT') {
                document.getElementById('story-panel-title').innerHTML = msg.title || 'KWENTONG<br>GABI';
                document.getElementById('story-panel-desc').innerHTML  = msg.desc  || '';
            }
        });

        // ============================================================
        // 1. WEBCAM
        // ============================================================
        async function startWebcam() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: { width:1920, height:1080 } });
                document.getElementById('webcam-feed').srcObject = stream;
            } catch (err) { console.error("Camera Error:", err); }
        }
        startWebcam();

        // ============================================================
        // 2. KEYBOARD CONTROLS
        //    W = Waiting  S = Shoutout  T = Story  N = Transition
        //    J = Jumpscare  R = Raid Alert
        // ============================================================
        let isTransitioning = false, isWaiting = false, isStoryMode = false, isShoutout = false;

        document.addEventListener('keydown', (e) => {
            const k = e.key.toUpperCase();
            if (k === 'W') toggleWaiting();
            if (k === 'S') toggleShoutout();
            if (k === 'T') toggleStoryMode();
            if (k === 'N' && !isTransitioning) triggerStoryTransition();
            if (k === 'J') triggerJumpscare();
            if (k === 'R') triggerRaidAlert('Unknown Raider', '???');
        });

        function toggleWaiting() {
            isWaiting = !isWaiting;
            document.getElementById('waiting-screen').classList.toggle('active', isWaiting);
        }
        function toggleShoutout() {
            isShoutout = !isShoutout;
            document.body.classList.toggle('shoutout-mode', isShoutout);
            updateShoutoutBoard();
        }
        function toggleStoryMode() {
            isStoryMode = !isStoryMode;
            document.body.classList.toggle('story-mode', isStoryMode);
        }
        function triggerStoryTransition() {
            isTransitioning = true;
            const transLayer = document.getElementById('story-transition');
            tryPlay('horror-sfx');
            transLayer.classList.add('active');
            setTimeout(() => {
                transLayer.classList.remove('active');
                setTimeout(() => { isTransitioning = false; }, 500);
            }, 4500);
        }

        // ============================================================
        // 3. SHOUTOUT DATA
        // ============================================================
        let uniqueCommenters = new Set();
        const SOUL_ICONS = ['‚Ä†','‚òΩ','‚ú¶','‚ÅÇ','‚úß','‚ò©','‚ö∞','‚úù'];

        function updateShoutoutBoard() {
            const list  = document.getElementById('shoutout-list');
            const count = document.getElementById('soul-count');
            count.textContent = uniqueCommenters.size;
            list.innerHTML = '';
            if (uniqueCommenters.size === 0) {
                list.innerHTML = `<li class="shoutout-item" style="opacity:0.4;animation:none;"><span class="soul-number">‚Äî</span><span class="soul-icon">‚òΩ</span><span class="soul-name" style="color:rgba(255,255,255,0.3);font-size:16px;letter-spacing:4px;">AWAITING VICTIMS</span></li>`;
                return;
            }
            Array.from(uniqueCommenters).slice(-12).reverse().forEach((name, i) => {
                const li = document.createElement('li');
                li.className = 'shoutout-item' + (i === 0 ? ' newest' : '');
                li.style.animationDelay = `${i * 0.08}s`;
                const rank = uniqueCommenters.size - i;
                li.innerHTML = `<span class="soul-number">${String(rank).padStart(2,'0')}</span><span class="soul-icon">${SOUL_ICONS[i%SOUL_ICONS.length]}</span><span class="soul-name">${name}</span><span class="soul-pulse"></span>`;
                list.appendChild(li);
            });
        }

        // ============================================================
        // 4. CLOCK & GLITCH
        // ============================================================
        function updateClock() {
            const t = new Date().toLocaleTimeString('en-US', {hour12:false, hour:'2-digit', minute:'2-digit', second:'2-digit'});
            document.getElementById('live-clock').innerText = t;
        }
        setInterval(updateClock, 1000); updateClock();

        function triggerRandomGlitch() {
            const g = document.getElementById('glitch-overlay');
            g.classList.add('glitching');
            setTimeout(() => g.classList.remove('glitching'), 100 + Math.random() * 200);
            setTimeout(triggerRandomGlitch, 10000 + Math.random() * 15000);
        }
        setTimeout(triggerRandomGlitch, 5000);

        // ============================================================
        // 5. FEAR METER
        // ============================================================
        let fearLevel = 0; // 0-100
        const FEAR_DECAY_INTERVAL = 25000; // -8 every 25s
        const FEAR_PER_COMMENT    = 4;

        function setFear(level) {
            fearLevel = Math.max(0, Math.min(100, level));
            const fill    = document.getElementById('fear-fill');
            const pct     = document.getElementById('fear-percent');
            fill.style.height = fearLevel + '%';
            pct.textContent   = Math.round(fearLevel) + '%';
            // Color shift
            if (fearLevel < 30) {
                fill.style.background = 'linear-gradient(to top, #c90000, #ff4400)';
                fill.style.boxShadow  = '0 0 12px rgba(201,0,0,0.5)';
                document.body.classList.remove('fear-max');
            } else if (fearLevel < 70) {
                fill.style.background = 'linear-gradient(to top, #c90000, #ff4400, #ff6600)';
                fill.style.boxShadow  = '0 0 18px rgba(255,70,0,0.7)';
                document.body.classList.remove('fear-max');
            } else {
                fill.style.background = 'linear-gradient(to top, #8b0000, #c90000, #ff2200, #ff6600)';
                fill.style.boxShadow  = '0 0 28px rgba(255,0,0,0.9)';
                if (fearLevel >= 100) {
                    document.body.classList.add('fear-max');
                    triggerRandomGlitch(); // Extra glitch at max fear
                }
            }
        }
        function addFear(amount) { setFear(fearLevel + amount); }
        // Decay
        setInterval(() => { if (fearLevel > 0) setFear(fearLevel - 8); }, FEAR_DECAY_INTERVAL);

        // ============================================================
        // 6. KEYWORD REACTIONS
        // ============================================================
        const KEYWORD_MAP = [
            // [regex, effect_fn]
            [/\b(takot|nakakatakot|takot ako|natatakot)\b/i, () => {
                addFear(15);
                triggerFlash('red-flash');
                showKeywordPop('üò± TAKOT!');
            }],
            [/\b(putangina|puta|gago|tangina|putang|wtf|omg|fck|fuck)\b/i, () => {
                addFear(10);
                document.body.classList.add('screen-shake');
                setTimeout(() => document.body.classList.remove('screen-shake'), 600);
                triggerFlash('red-flash');
            }],
            [/\b(huwag|wag|don't|dont|stop|tigil)\b/i, () => {
                addFear(8);
                triggerFlash('dark-flash');
                showKeywordPop('HUWAG...');
            }],
            [/\b(ilaw|lights|bukas|liwanag)\b/i, () => {
                document.body.classList.add('brightened');
                setTimeout(() => document.body.classList.remove('brightened'), 2000);
                showKeywordPop('üí° ILAW');
            }],
            [/\b(laban|kaya|go|sige|tara|tuloy)\b/i, () => {
                addFear(5);
                showKeywordPop('TULOY!');
            }],
            [/\b(namatay|patay|dead|ghost|multo|kaluluwa)\b/i, () => {
                addFear(20);
                triggerFlash('red-flash');
                triggerRandomGlitch();
                showKeywordPop('üëª');
            }],
        ];

        function checkKeywords(text) {
            for (const [regex, fn] of KEYWORD_MAP) {
                if (regex.test(text)) { fn(); break; }
            }
        }

        function triggerFlash(type) {
            const f = document.getElementById('flash-overlay');
            f.className = type;
            setTimeout(() => { f.className = ''; }, 700);
        }

        let keywordPopTimer = null;
        function showKeywordPop(text) {
            const el = document.getElementById('keyword-pop');
            clearTimeout(keywordPopTimer);
            el.className = '';
            el.textContent = text;
            void el.offsetWidth; // reflow
            el.className = 'pop-in';
            keywordPopTimer = setTimeout(() => { el.className = ''; }, 1200);
        }

        // ============================================================
        // 7. EMF GHOST DETECTOR
        // ============================================================
        let emfTarget = 20;
        let emfCurrent = 20;
        let emfSpiking = false;

        function updateEMF() {
            // Drift towards target with some noise
            emfCurrent += (emfTarget - emfCurrent) * 0.1 + (Math.random() - 0.5) * 4;
            emfCurrent = Math.max(0, Math.min(100, emfCurrent));

            // Needle rotation: -80deg (left) to +80deg (right)
            const angle = -80 + (emfCurrent / 100) * 160;
            document.getElementById('emf-needle').style.transform = `rotate(${angle}deg)`;

            const reading = document.getElementById('emf-reading');
            const zone    = document.getElementById('emf-zone-label');
            const dot     = document.getElementById('emf-status-dot');
            const mG      = (emfCurrent * 0.85).toFixed(1);
            reading.textContent = mG + ' mG';

            if (emfCurrent < 25) {
                reading.className = 'emf-reading';
                zone.textContent  = 'NO ACTIVITY';
                zone.className    = 'emf-zone-label';
                dot.className     = 'emf-dot';
            } else if (emfCurrent < 60) {
                reading.className = 'emf-reading';
                zone.textContent  = 'PRESENCE NEARBY';
                zone.className    = 'emf-zone-label active-zone';
                dot.className     = 'emf-dot';
            } else {
                reading.className = 'emf-reading danger';
                zone.textContent  = '‚ö† ENTITY DETECTED';
                zone.className    = 'emf-zone-label active-zone';
                dot.className     = 'emf-dot spike';
                if (!emfSpiking) {
                    emfSpiking = true;
                    tryPlay('emf-beep');
                    addFear(12);
                    triggerFlash('red-flash');
                    setTimeout(() => { emfSpiking = false; }, 5000);
                }
            }
        }

        function randomEMFTarget() {
            // Mostly calm, occasional spikes
            const r = Math.random();
            if (r < 0.6)      emfTarget = 5  + Math.random() * 25;   // calm
            else if (r < 0.85) emfTarget = 30 + Math.random() * 30;  // moderate
            else               emfTarget = 70 + Math.random() * 30;  // spike!
            setTimeout(randomEMFTarget, 3000 + Math.random() * 8000);
        }

        setInterval(updateEMF, 150);
        setTimeout(randomEMFTarget, 4000);

        // ============================================================
        // 8. JUMPSCARE (J key)
        // ============================================================
        const JUMPSCARE_FACES = ['üíÄ','üëÅÔ∏è','üò±','üï∑Ô∏è','‚ò†Ô∏è'];
        let isJumpscaring = false;

        function triggerJumpscare() {
            if (isJumpscaring) return;
            isJumpscaring = true;
            const overlay = document.getElementById('jumpscare-overlay');
            const face    = overlay.querySelector('.jumpscare-face');
            face.textContent = JUMPSCARE_FACES[Math.floor(Math.random() * JUMPSCARE_FACES.length)];
            tryPlay('jumpscare-sfx');
            triggerFlash('white-flash');
            overlay.classList.add('active');
            addFear(25);
            setTimeout(() => {
                overlay.classList.remove('active');
                setTimeout(() => { isJumpscaring = false; }, 300);
            }, 800);
        }

        // ============================================================
        // 9. RAID ALERT (R key)
        // ============================================================
        let isRaiding = false;

        function triggerRaidAlert(channelName, viewerCount) {
            if (isRaiding) return;
            isRaiding = true;
            document.getElementById('raid-channel-name').textContent = channelName.toUpperCase();
            document.getElementById('raid-viewer-count').textContent = viewerCount + ' VIEWERS';
            tryPlay('raid-sfx');
            const overlay = document.getElementById('raid-overlay');
            overlay.classList.add('active');
            addFear(30);
            setTimeout(() => {
                overlay.classList.remove('active');
                setTimeout(() => { isRaiding = false; }, 500);
            }, 8000);
        }

        // ============================================================
        // 10. SUPER CHAT ALERT
        // ============================================================
        let scQueue = [];
        let isShowingSC = false;

        function showSuperChatAlert(author, message, amount, avatar) {
            scQueue.push({ author, message, amount, avatar });
            processSCQueue();
        }

        function processSCQueue() {
            if (isShowingSC || scQueue.length === 0) return;
            isShowingSC = true;
            const sc = scQueue.shift();
            document.getElementById('sc-author').textContent  = sc.author;
            document.getElementById('sc-message').textContent = sc.message || '(No message)';
            document.getElementById('sc-amount').textContent  = sc.amount;
            document.getElementById('sc-avatar').src          = sc.avatar || 'https://via.placeholder.com/64/111/fff?text=?';
            tryPlay('superchat-sfx');
            addFear(15);
            const el = document.getElementById('superchat-alert');
            el.classList.add('show');
            setTimeout(() => {
                el.classList.remove('show');
                setTimeout(() => { isShowingSC = false; processSCQueue(); }, 800);
            }, 9000);
        }

        // ============================================================
        // 11. GHOST NOTIFICATION (random)
        // ============================================================
        const GHOST_MESSAGES = [
            'Unknown viewer has joined the broadcast',
            '‚ö† Unusual activity detected ‚Äî CAM 04',
            'Signal interference on channel 04',
            'An unknown entity is watching you',
            'Motion detected at perimeter',
            '‚ö† Temperature drop: ‚àí12¬∞C in your area',
            'CAM 04 feed interrupted for 0.3s',
            'Electromagnetic anomaly recorded',
            'Someone typed a message ‚Äî then deleted it',
            '‚ö† You are not alone in this room',
        ];
        let ghostNotifTimer = null;

        function showGhostNotif(msg) {
            const el  = document.getElementById('ghost-notification');
            const msgEl  = document.getElementById('ghost-notif-msg');
            const timeEl = document.getElementById('ghost-notif-time');
            msgEl.textContent  = msg;
            timeEl.textContent = new Date().toLocaleTimeString('en-US', {hour12:false});
            el.classList.add('show');
            setTimeout(() => { el.classList.remove('show'); }, 4500);
        }

        function scheduleGhostNotif() {
            const delay = 90000 + Math.random() * 150000; // 1.5 - 4 min
            ghostNotifTimer = setTimeout(() => {
                const msg = GHOST_MESSAGES[Math.floor(Math.random() * GHOST_MESSAGES.length)];
                showGhostNotif(msg);
                scheduleGhostNotif();
            }, delay);
        }
        // First one after 30s
        setTimeout(() => showGhostNotif(GHOST_MESSAGES[0]), 30000);
        scheduleGhostNotif();

        // ============================================================
        // 12. YOUTUBE LIVE CHAT API
        // ============================================================
        let liveChatId = '', nextPageToken = '', commentQueue = [], isShowingComment = false;

        async function getLiveChatId() {
            if (!VIDEO_ID || !API_KEY) return;
            try {
                const res  = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=${VIDEO_ID}&key=${API_KEY}`);
                const data = await res.json();
                if (data.items && data.items.length > 0 && data.items[0].liveStreamingDetails) {
                    liveChatId = data.items[0].liveStreamingDetails.activeLiveChatId;
                    if (liveChatId) { fetchMessages(); setInterval(fetchMessages, 7000); }
                }
            } catch (err) { console.error("getLiveChatId:", err); }
        }

        async function fetchMessages() {
            if (!liveChatId) return;
            let url = `https://www.googleapis.com/youtube/v3/liveChat/messages?liveChatId=${liveChatId}&part=snippet,authorDetails&key=${API_KEY}`;
            if (nextPageToken) url += `&pageToken=${nextPageToken}`;
            try {
                const res = await fetch(url); const data = await res.json();
                if (data.nextPageToken) {
                    const isFirst = (nextPageToken === '');
                    nextPageToken = data.nextPageToken;
                    if (!isFirst && data.items && data.items.length > 0) {
                        data.items.forEach(item => {
                            const name = item.authorDetails.displayName;
                            const text = item.snippet.displayMessage || '';
                            const type = item.snippet.type;
                            uniqueCommenters.add(name);
                            const sc = document.getElementById('soul-count');
                            if (sc) sc.textContent = uniqueCommenters.size;

                            // Regular chat ‚Üí add fear, check keywords
                            addFear(FEAR_PER_COMMENT);
                            checkKeywords(text);

                            // Super Chat detection
                            if (type === 'superChatEvent') {
                                const amt    = item.snippet.superChatDetails;
                                const amount = amt ? (amt.amountDisplayString || '???') : '???';
                                const scMsg  = amt ? (amt.userComment || '') : '';
                                showSuperChatAlert(name, scMsg, amount, item.authorDetails.profileImageUrl);
                            }

                            commentQueue.push({ author: name, text, avatar: item.authorDetails.profileImageUrl });
                        });
                        processCommentQueue();
                    }
                }
            } catch (err) { console.error("fetchMessages:", err); }
        }

        function processCommentQueue() {
            if (isShowingComment || commentQueue.length === 0) return;
            if (document.body.classList.contains('shoutout-mode')) return;
            isShowingComment = true;
            const c = commentQueue.shift();
            document.getElementById('comment-author').innerText = c.author;
            document.getElementById('comment-text').innerText   = c.text;
            document.getElementById('comment-avatar').src       = c.avatar || 'https://via.placeholder.com/70/111/fff?text=?';
            document.getElementById('comment-container').classList.add('show');
            setTimeout(() => {
                document.getElementById('comment-container').classList.remove('show');
                setTimeout(() => { isShowingComment = false; processCommentQueue(); }, 1000);
            }, 6000);
        }

        getLiveChatId();

        // ============================================================
        // AUDIO HELPER (handles browser autoplay block)
        // ============================================================
        function tryPlay(id) {
            const a = document.getElementById(id);
            if (!a) return;
            a.currentTime = 0;
            a.play().catch(() => {});
        }

        // Enable audio on first click
        document.addEventListener('click', () => {
            ['horror-sfx','jumpscare-sfx','emf-beep','raid-sfx','superchat-sfx']
                .forEach(id => { const a = document.getElementById(id); if (a) a.load(); });
        }, { once: true });
    </script>
</body>
</html>
